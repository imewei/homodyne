{
  "metadata": {
    "_comment": "Project metadata for static isotropic analysis",
    "config_version": "6.0",
    "description": "Static Isotropic Scattering Analysis - No flow, no angular dependence",
    "analysis_mode": "static_isotropic",
    "created_date": "2025-08-17",
    "updated_date": "2025-08-17",
    "authors": [
      "Wei Chen"
    ],
    "institution": "Argonne National Laboratory",
    "experiment_name": "Testing",
    "sample_description": "Simon PNAS",
    "script_compatibility": "homodyne.py"
  },
  "experimental_data": {
    "_comment": "Data configuration for isotropic static mode",
    "description": "Data source configuration - phi_angles_file ignored in isotropic mode",
    "data_folder_path": "./data/Simon/",
    "data_file_name": "your_data_file.hdf",
    "phi_angles_path": "./data/Simon/",
    "_phi_angles_path_note": "Path ignored in isotropic mode - dummy angles used instead",
    "phi_angles_file": "phi_list.txt",
    "_phi_angles_file_note": "File ignored in isotropic mode - single dummy angle used",
    "exchange_key": "exchange",
    "cache_file_path": "./data/Simon/",
    "cache_filename_template": "cached_c2_isotropic_frames_{start_frame}_{end_frame}.npz",
    "cache_compression": true,
    "data_type": "float64",
    "file_format": "NPZ",
    "preprocessing": {
      "_comment": "Optimized for isotropic mode",
      "apply_diagonal_correction": true,
      "vectorized_correction": true,
      "cache_processed_data": true,
      "normalize_data": true,
      "normalization_method": "baseline"
    }
  },
  "analyzer_parameters": {
    "_comment": "Analysis parameters optimized for static isotropic mode",
    "temporal": {
      "dt": 0.5,
      "_dt_note": "Time step - same importance as other modes",
      "dt_unit": "seconds",
      "start_frame": 400,
      "end_frame": 1000
    },
    "scattering": {
      "wavevector_q": 0.0237,
      "_wavevector_q_note": "q-vector magnitude - isotropic so angular averaging applied",
      "q_unit": "Å⁻¹"
    },
    "geometry": {
      "_comment": "Geometry parameters - gap still relevant for potential future use",
      "stator_rotor_gap": 2000000,
      "gap_unit": "Å",
      "_gap_note": "Gap parameter kept for consistency but not used in static mode"
    },
    "computational": {
      "num_threads": 8,
      "auto_detect_cores": true,
      "max_threads_limit": 16,
      "memory_limit_gb": 8
    }
  },
  "initial_parameters": {
    "_comment": "Initial parameters for static isotropic mode - only diffusion parameters matter",
    "description": "Only D0, alpha, D_offset are physically meaningful in static isotropic mode",
    "values": [
      16000,
      -1.5,
      1.10,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "_values_note": "Last 4 parameters (shear + phi0) automatically set to 0 in static mode",
    "parameter_names": [
      "D0",
      "alpha",
      "D_offset",
      "gamma_dot_t0",
      "beta",
      "gamma_dot_t_offset",
      "phi0"
    ],
    "units": [
      "Å²/s",
      "dimensionless",
      "Å²/s",
      "s⁻¹",
      "dimensionless",
      "s⁻¹",
      "degrees"
    ],
    "physical_meaning": {
      "D0": "Reference diffusion coefficient - PRIMARY PARAMETER",
      "alpha": "Power-law exponent for D(t) evolution - PRIMARY PARAMETER",
      "D_offset": "Baseline diffusion coefficient - PRIMARY PARAMETER",
      "gamma_dot_t0": "Ignored in static mode (automatically set to 0)",
      "beta": "Ignored in static mode (automatically set to 0)",
      "gamma_dot_t_offset": "Ignored in static mode (automatically set to 0)",
      "phi0": "Irrelevant in isotropic mode (automatically set to 0)"
    },
    "active_parameters": [
      "D0",
      "alpha",
      "D_offset"
    ],
    "_active_parameters_note": "Only these 3 parameters are optimized in static isotropic mode"
  },
  "optimization_config": {
    "_comment": "Optimization for static isotropic mode",
    "angle_filtering": {
      "_comment": "Angle filtering automatically disabled in isotropic mode",
      "enabled": false,
      "_enabled_note": "Automatically disabled in static isotropic mode regardless of setting",
      "target_ranges": [],
      "_target_ranges_note": "Empty - no angle filtering in isotropic mode",
      "fallback_to_all_angles": true,
      "_isotropic_mode_note": "Angle filtering is automatically disabled for static isotropic mode"
    },
    "classical_optimization": {
      "methods": [
        "Nelder-Mead"
      ],
      "method_options": {
        "Nelder-Mead": {
          "maxiter": 5000,
          "_maxiter_note": "Reduced iterations since only 3 parameters to optimize",
          "xatol": 1e-08,
          "fatol": 1e-08,
          "adaptive": true
        }
      }
    },
    "mcmc_sampling": {
      "enabled": true,
      "sampler": "NUTS",
      "draws": 8000,
      "_draws_note": "Fewer draws needed with only 3 parameters",
      "tune": 1000,
      "chains": 8,
      "cores": 8,
      "target_accept": 0.95,
      "max_treedepth": 10,
      "return_inferencedata": true
    }
  },
  "parameter_space": {
    "_comment": "Parameter bounds - only first 3 are used in static isotropic mode",
    "bounds": [
      {
        "name": "D0",
        "min": 1.0,
        "max": 1e6,
        "type": "log-uniform",
        "prior_mu": 1.6e4,
        "prior_sigma": 0.5,
        "unit": "Å²/s",
        "physical_constraint": "positive",
        "_note": "PRIMARY PARAMETER - reference diffusion coefficient"
      },
      {
        "name": "alpha",
        "min": -1.8,
        "max": -1.2,
        "type": "uniform",
        "prior_mu": -1.57,
        "prior_sigma": 0.5,
        "unit": "dimensionless",
        "physical_constraint": "none",
        "_note": "PRIMARY PARAMETER - diffusion time dependence exponent. Bounds widened to avoid initialization at hard boundary."
      },
      {
        "name": "D_offset",
        "min": -5000,
        "max": 5000,
        "type": "uniform",
        "prior_mu": 3.0,
        "prior_sigma": 0.5,
        "unit": "Å²/s",
        "physical_constraint": "none",
        "_note": "PRIMARY PARAMETER - baseline diffusion coefficient"
      },
      {
        "name": "gamma_dot_t0",
        "min": 0.0,
        "max": 0.0,
        "_bounds_note": "Fixed at 0 in static mode",
        "type": "fixed",
        "unit": "s⁻¹",
        "physical_constraint": "fixed_zero"
      },
      {
        "name": "beta",
        "min": 0.0,
        "max": 0.0,
        "_bounds_note": "Fixed at 0 in static mode",
        "type": "fixed",
        "unit": "dimensionless",
        "physical_constraint": "fixed_zero"
      },
      {
        "name": "gamma_dot_t_offset",
        "min": 0.0,
        "max": 0.0,
        "_bounds_note": "Fixed at 0 in static mode",
        "type": "fixed",
        "unit": "s⁻¹",
        "physical_constraint": "fixed_zero"
      },
      {
        "name": "phi0",
        "min": 0.0,
        "max": 0.0,
        "_bounds_note": "Fixed at 0 - irrelevant in isotropic mode",
        "type": "fixed",
        "unit": "degrees",
        "physical_constraint": "fixed_zero"
      }
    ]
  },
  "analysis_settings": {
    "_comment": "Static isotropic mode configuration",
    "static_mode": true,
    "_static_mode_note": "REQUIRED: Must be true for static analysis",
    "static_submode": "isotropic",
    "_static_submode_note": "REQUIRED: Must be 'isotropic' for this template",
    "model_description": {
      "current_mode": "static_isotropic_case",
      "equation": "g₁(t₁,t₂) = exp(-q² ∫ᵗ²ᵗ¹ D(t)dt), g₂(t₁,t₂) ~ [g₁(t₁,t₂)]²",
      "description": "Pure diffusion with no angular dependence",
      "key_features": [
        "No flow effects (γ̇ = 0)",
        "No angular dependence (isotropic)",
        "Only diffusion dynamics D(t) = D₀(t/t₀)^α + D_offset",
        "3 active parameters: D0, alpha, D_offset"
      ]
    }
  },
  "advanced_settings": {
    "data_loading": {
      "use_diagonal_correction": true,
      "vectorized_diagonal_fix": true
    },
    "chi_squared_calculation": {
      "method": "standard",
      "_scaling_optimization_note": "Scaling optimization is always enabled: g₂ = offset + contrast × g₁. This is essential for proper chi-squared calculation regardless of mode or number of angles.",
      "_scaling_details": {
        "_purpose": "Performs least squares fitting to determine contrast and offset parameters",
        "_accounts_for": [
          "instrumental response",
          "background signals",
          "detector variations",
          "normalization differences"
        ],
        "_chi_squared_formula": "χ² = Σ(experimental - fitted)²/σ² where fitted = theory × contrast + offset",
        "_implementation": "Uses numpy.linalg.lstsq to solve A·x = b where A = [theory, ones], x = [contrast, offset]",
        "_isotropic_mode_benefits": [
          "Single scaling relationship applied (no angular dependence)",
          "Faster computation due to simplified geometry",
          "Robust fitting with isotropic averaging",
          "Consistent results independent of sample orientation"
        ],
        "_typical_values_isotropic": {
          "contrast": "0.5-2.0 (narrower range due to isotropic averaging)",
          "offset": "0.01-0.05 (typically smaller due to reduced background anisotropy)"
        }
      },
      "uncertainty_estimation_factor": 0.1,
      "minimum_sigma": 1e-10,
      "fast_computation": true,
      "validity_check": {
        "check_positive_D0": true,
        "check_positive_gamma_dot_t0": false,
        "_check_positive_gamma_dot_t0_note": "Disabled - parameter fixed at 0",
        "check_positive_time_dependent": true,
        "check_parameter_bounds": true
      }
    }
  },
  "performance_settings": {
    "caching": {
      "enable_memory_cache": true,
      "enable_disk_cache": true,
      "cache_size_limit_mb": 1000,
      "auto_cleanup": true
    },
    "parallel_processing": {
      "enable_multiprocessing": true,
      "chunk_size": "auto",
      "backend": "threading"
    },
    "noise_model": {
      "use_simple_forward_model": false,
      "sigma_prior": 0.1,
      "_isotropic_note": "Full forward model with scaling optimization enabled for MCMC consistency",
      "_mcmc_note": "MCMC ALWAYS uses scaling optimization to match classical/Bayesian optimization results"
    }
  },
  "output_settings": {
    "reporting": {
      "generate_plots": true,
      "plot_formats": [
        "png",
        "pdf"
      ],
      "detailed_summary": true
    },
    "plotting": {
      "general": {
        "create_plots": true,
        "plot_format": "png",
        "dpi": 300,
        "figure_size": [
          10,
          8
        ],
        "style": "publication"
      },
      "c2_heatmaps": {
        "enabled": true,
        "_enabled_note": "Single angle heatmaps for isotropic mode",
        "layout": "single_row",
        "include_experimental": true,
        "include_theoretical": true,
        "include_residuals": true,
        "title_prefix": "C2 Isotropic Static Mode"
      },
      "mcmc_plots": {
        "enabled": true,
        "corner_plots": {
          "enabled": true,
          "figsize": [
            8,
            8
          ],
          "_figsize_note": "Smaller size for 3x3 parameter space"
        },
        "trace_plots": {
          "enabled": true,
          "figsize": [
            10,
            6
          ],
          "_figsize_note": "Compact layout for 3 parameters"
        }
      }
    }
  },
  "_usage_notes": {
    "description": "Specific usage notes for static isotropic mode",
    "key_differences": [
      "phi_angles_file is not loaded - dummy angles used automatically",
      "Angle filtering is disabled regardless of configuration",
      "Only 3 parameters (D0, alpha, D_offset) are optimized",
      "Shear and phi0 parameters are automatically set to 0",
      "Results are independent of scattering angle",
      "Faster optimization due to fewer parameters and no angle selection"
    ],
    "when_to_use": [
      "Static samples with no applied flow or rotation",
      "Isotropic scattering where results don't depend on angle",
      "Quick analysis focusing only on diffusion dynamics",
      "Systems where angular anisotropy is not expected or relevant"
    ],
    "performance_benefits": [
      "Faster optimization (3 vs 7 parameters)",
      "No angle file loading overhead",
      "No angle filtering computational cost",
      "Simpler parameter space for MCMC"
    ]
  },
  "validation_rules": {
    "_comment": "Validation rules for static isotropic mode",
    "fit_quality": {
      "_comment": "Classical optimization fit quality for 3-parameter isotropic analysis",
      "_applies_to": "Classical optimization methods only (Nelder-Mead, etc.)",
      "overall_chi_squared": {
        "excellent_threshold": 2.0,
        "acceptable_threshold": 5.0,
        "warning_threshold": 10.0,
        "critical_threshold": 20.0,
        "_isotropic_note": "Isotropic averaging may improve fit quality vs anisotropic"
      },
      "per_angle_chi_squared": {
        "excellent_threshold": 2.0,
        "acceptable_threshold": 5.0,
        "warning_threshold": 10.0,
        "outlier_threshold_multiplier": 2.5,
        "max_outlier_fraction": 0.25,
        "min_good_angles": 1,
        "_min_good_angles_note": "Only 1 angle minimum for isotropic (single dummy angle)"
      }
    },
    "mcmc_convergence": {
      "_comment": "MCMC convergence validation for 3-parameter static isotropic analysis",
      "_applies_to": "MCMC/NUTS sampling methods only",
      "_note": "Isotropic mode uses MCMC convergence diagnostics instead of chi-squared",
      "rhat_thresholds": {
        "_comment": "R-hat thresholds for simplified 3-parameter isotropic model",
        "excellent_threshold": 1.01,
        "_excellent_threshold_note": "R̂ ≤ 1.01 indicates excellent convergence",
        "good_threshold": 1.05,
        "_good_threshold_note": "R̂ ≤ 1.05 indicates good convergence for isotropic model",
        "acceptable_threshold": 1.1,
        "_acceptable_threshold_note": "R̂ ≤ 1.1 indicates acceptable convergence",
        "critical_threshold": 1.15,
        "_critical_threshold_note": "R̂ > 1.15 indicates poor convergence"
      },
      "ess_thresholds": {
        "_comment": "ESS thresholds for 3-parameter isotropic space",
        "excellent_threshold": 400,
        "_excellent_threshold_note": "ESS ≥ 400 excellent for 3-parameter space",
        "good_threshold": 200,
        "_good_threshold_note": "ESS ≥ 200 good for isotropic analysis",
        "acceptable_threshold": 100,
        "_acceptable_threshold_note": "ESS ≥ 100 acceptable for static isotropic",
        "minimum_threshold": 50,
        "_minimum_threshold_note": "ESS < 50 inadequate for parameter estimates"
      },
      "divergence_thresholds": {
        "_comment": "Divergence criteria for simple isotropic geometry",
        "max_divergences_fraction": 0.01,
        "_max_divergences_fraction_note": "1% max divergences for simple isotropic model",
        "warning_divergences_fraction": 0.005,
        "_warning_divergences_fraction_note": "0.5% divergences warrants investigation"
      },
      "quality_assessment": {
        "_comment": "Isotropic-specific MCMC quality criteria",
        "excellent_criteria": "R̂ < 1.01 AND ESS > 400 AND divergences < 0.5%",
        "good_criteria": "R̂ < 1.05 AND ESS > 200 AND divergences < 1%",
        "acceptable_criteria": "R̂ < 1.1 AND ESS > 100 AND divergences < 1%",
        "poor_criteria": "Any criterion fails to meet acceptable threshold",
        "_isotropic_note": "3-parameter isotropic model should converge efficiently"
      }
    },
    "parameter_validation": {
      "_comment": "Parameter validation for static isotropic mode",
      "check_bounds": true,
      "physics_constraints": true,
      "correlation_checks": true,
      "_isotropic_constraints": [
        "D0 must be positive (physical diffusion)",
        "Only D0, alpha, D_offset are optimized",
        "Flow parameters automatically set to 0",
        "phi0 automatically set to 0 (irrelevant in isotropic mode)"
      ]
    }
  }
}